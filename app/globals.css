@tailwind base;
@tailwind components;
@tailwind utilities;

/* Prevent double scrollbars */
html,
body {
  overflow: hidden;
  height: 100%;
  margin: 0;
  padding: 0;
}

/* Background texture system */
body {
  background:
    /* 点状网格 - 精致的纹理 */
    radial-gradient(
      circle at center,
      var(--bg-dot-grid) 1px,
      transparent 1px
    ),
    /* 大网格 - 增加结构感 */
    repeating-linear-gradient(
      0deg,
      transparent,
      transparent 79px,
      var(--bg-large-grid) 79px,
      var(--bg-large-grid) 80px
    ),
    repeating-linear-gradient(
      90deg,
      transparent,
      transparent 79px,
      var(--bg-large-grid) 79px,
      var(--bg-large-grid) 80px
    ),
    /* 顶部品牌色光晕 */
    radial-gradient(
      ellipse 1200px 500px at 50% 0px,
      var(--bg-brand-halo),
      transparent 70%
    ),
    /* 底部柔和光晕 */
    radial-gradient(
      ellipse 800px 300px at 50% 100%,
      var(--bg-soft-glow),
      transparent 60%
    ),
    /* 基础渐变背景 */
    linear-gradient(
      to bottom,
      var(--bg-gradient-start) 0%,
      var(--bg-gradient-30) 30%,
      var(--bg-gradient-50) 50%,
      var(--bg-gradient-70) 70%,
      var(--bg-gradient-end) 100%
    );
  background-size:
    24px 24px,    /* 点状网格 */
    80px 80px,    /* 垂直大网格 */
    80px 80px,    /* 水平大网格 */
    100% 100%,    /* 顶部光晕 */
    100% 100%,    /* 底部光晕 */
    100% 100%;    /* 基础渐变 */
  background-attachment: fixed;
}

/* Content area with frosted glass effect */
.content-area {
  max-width: 900px;
  margin: 0 auto;
  background: hsl(var(--background) / 0.6);
  backdrop-filter: blur(10px);
  min-height: calc(100vh - 64px); /* Full height minus navbar */
  box-shadow: 0 0 0 1px hsl(var(--border) / 0.3);
}

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 222 84% 4.9%;

    --card: 0 0% 100%;
    --card-foreground: 222 84% 4.9%;

    --popover: 0 0% 100%;
    --popover-foreground: 222 84% 4.9%;

    --primary: 221 83% 53%;
    --primary-foreground: 210 40% 98%;

    --secondary: 210 40% 96.1%;
    --secondary-foreground: 222 84% 4.9%;

    --muted: 210 40% 96.1%;
    --muted-foreground: 215 16% 47%;

    --accent: 210 40% 96.1%;
    --accent-foreground: 222 84% 4.9%;

    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 210 40% 98%;

    --border: 214 32% 91%;
    --input: 214 32% 91%;
    --ring: 221 83% 53%;

    --radius: 0.5rem;

    /* Custom theme colors for Skill Factory */
    --brand-primary: 221 83% 53%;      /* GitHub blue #0969da */
    --brand-secondary: 215 16% 47%;    /* Gray #57606a */
    --success: 137 55% 15%;            /* Green #1a7f37 */
    --success-foreground: 137 72% 94%; /* Light green */

    /* Background gradient system - Light mode */
    --bg-dot-grid: rgba(0, 0, 0, 0.035);
    --bg-large-grid: rgba(0, 0, 0, 0.02);
    --bg-brand-halo: rgba(9, 105, 218, 0.05);
    --bg-soft-glow: rgba(100, 116, 139, 0.03);
    --bg-gradient-start: #f5f7f9;
    --bg-gradient-30: #f8f9fb;
    --bg-gradient-50: #fafbfc;
    --bg-gradient-70: #f7f9fa;
    --bg-gradient-end: #f5f6f8;
  }

  .dark {
    --background: 222 84% 4.9%;
    --foreground: 210 40% 98%;

    --card: 222 84% 4.9%;
    --card-foreground: 210 40% 98%;

    --popover: 222 84% 4.9%;
    --popover-foreground: 210 40% 98%;

    --primary: 217 91% 60%;
    --primary-foreground: 222 84% 4.9%;

    --secondary: 217 33% 17%;
    --secondary-foreground: 210 40% 98%;

    --muted: 217 33% 17%;
    --muted-foreground: 215 20% 65%;

    --accent: 217 33% 17%;
    --accent-foreground: 210 40% 98%;

    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 210 40% 98%;

    --border: 217 33% 17%;
    --input: 217 33% 17%;
    --ring: 224 76% 48%;

    /* Custom theme colors for Skill Factory - Dark mode */
    --brand-primary: 217 91% 60%;      /* Lighter blue for dark mode */
    --brand-secondary: 215 20% 65%;    /* Lighter gray */
    --success: 142 76% 36%;            /* Lighter green */
    --success-foreground: 137 72% 94%;

    /* Background gradient system - Dark mode (inverted) */
    --bg-dot-grid: rgba(255, 255, 255, 0.035);
    --bg-large-grid: rgba(255, 255, 255, 0.02);
    --bg-brand-halo: rgba(84, 174, 255, 0.08);
    --bg-soft-glow: rgba(148, 163, 184, 0.05);
    --bg-gradient-start: #0f1419;
    --bg-gradient-30: #131920;
    --bg-gradient-50: #161b22;
    --bg-gradient-70: #1c2128;
    --bg-gradient-end: #22272e;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;

    /* Multi-layer gradient background system */
    background:
      /* Dot grid pattern */
      radial-gradient(
        circle at center,
        var(--bg-dot-grid) 1px,
        transparent 1px
      ),
      /* Large structural grid - horizontal */
      repeating-linear-gradient(
        0deg,
        transparent,
        transparent 79px,
        var(--bg-large-grid) 79px,
        var(--bg-large-grid) 80px
      ),
      /* Large structural grid - vertical */
      repeating-linear-gradient(
        90deg,
        transparent,
        transparent 79px,
        var(--bg-large-grid) 79px,
        var(--bg-large-grid) 80px
      ),
      /* Top brand halo */
      radial-gradient(
        ellipse 1200px 500px at 50% 0px,
        var(--bg-brand-halo),
        transparent 70%
      ),
      /* Bottom soft glow */
      radial-gradient(
        ellipse 800px 400px at 50% 100%,
        var(--bg-soft-glow),
        transparent 70%
      ),
      /* Base gradient background */
      linear-gradient(
        180deg,
        var(--bg-gradient-start) 0%,
        var(--bg-gradient-30) 30%,
        var(--bg-gradient-50) 50%,
        var(--bg-gradient-70) 70%,
        var(--bg-gradient-end) 100%
      );
    background-size:
      20px 20px,     /* dot grid */
      80px 80px,     /* large grid horizontal */
      80px 80px,     /* large grid vertical */
      100% 100%,     /* top halo */
      100% 100%,     /* bottom glow */
      100% 100%;     /* base gradient */
    background-attachment: fixed;
  }
}

/* ============================================
   LINEAR MESSAGE FLOW (No bubbles)
   ============================================ */

.message-item {
  padding: 0.75rem 0;
  animation: fadeIn 0.3s ease-out;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Message headers */
.message-header {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  margin-bottom: 0.5rem;
}

.message-avatar {
  width: 24px;
  height: 24px;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  font-size: 0.875rem;
}

.user-avatar {
  background: hsl(var(--muted));
  color: hsl(var(--foreground));
  border: 1px solid hsl(var(--border));
}

.agent-avatar {
  background: hsl(var(--foreground));
  color: hsl(var(--background));
}

.message-role {
  font-weight: 600;
  font-size: 0.875rem;
  color: hsl(var(--foreground));
}

/* Message content - clean text layout */
.message-content {
  font-size: 0.9375rem;
  line-height: 1.7;
  color: hsl(var(--foreground));
  padding-left: 2.25rem; /* Align with text after avatar */
}

.message-content p {
  margin-bottom: 0.5rem;
}

.message-content strong {
  font-weight: 600;
}

.message-content ul {
  list-style: disc;
  padding-left: 1.5rem;
  margin: 0.5rem 0;
}

.message-content li {
  margin-bottom: 0.25rem;
}

/* ============================================
   SUGGESTION BUTTONS
   ============================================ */

.suggestion-buttons {
  display: flex;
  gap: 0.5rem;
  flex-wrap: wrap;
  margin-top: 1rem;
  padding-left: 2.25rem;
}

.suggestion-btn {
  background: hsl(var(--card));
  border: 1.5px solid hsl(var(--border));
  border-radius: 8px;
  padding: 0.625rem 1.125rem;
  font-size: 0.875rem;
  color: hsl(var(--foreground));
  cursor: pointer;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  display: flex;
  align-items: center;
  gap: 0.5rem;
  box-shadow: 0 1px 3px hsl(var(--foreground) / 0.06);
}

.suggestion-btn:hover {
  background: hsl(var(--accent));
  border-color: hsl(var(--primary));
  color: hsl(var(--primary));
  transform: translateY(-1px);
  box-shadow: 0 2px 6px hsl(var(--primary) / 0.12);
}

/* ============================================
   AGENT LOG CONTAINER
   ============================================ */

.agent-log-section {
  margin-top: 1rem;
  padding-left: 2.25rem;
}

.agent-log-container {
  background: hsl(var(--card));
  border: 1px solid hsl(var(--border));
  border-radius: 10px;
  font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
  font-size: 0.875rem;
  overflow: hidden;
  box-shadow: 0 2px 6px hsl(var(--foreground) / 0.06);
}

.log-header {
  padding: 0.75rem 1rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: hsl(var(--muted));
}

.log-header-title {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-weight: 600;
  color: hsl(var(--foreground));
}

.log-body {
  padding: 0.5rem 0;
  max-height: 300px;
  overflow-y: auto;
}

.log-line {
  padding: 0.5rem 1rem;
  border-left: 3px solid transparent;
  transition: all 0.15s ease;
  display: flex;
  align-items: flex-start;
  gap: 0.75rem;
}

.log-line:hover {
  background: hsl(var(--muted));
}

.log-icon {
  width: 18px;
  height: 18px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  font-size: 0.75rem;
  margin-top: 0.125rem;
}

.log-content {
  flex: 1;
  color: hsl(var(--foreground));
  line-height: 1.5;
}

.log-meta {
  font-size: 0.75rem;
  color: hsl(var(--muted-foreground));
  margin-top: 0.125rem;
}

.log-timestamp {
  font-size: 0.6875rem;
  color: hsl(var(--muted-foreground));
  margin-left: auto;
  padding-left: 1rem;
  white-space: nowrap;
}

/* Log status styles */
.log-active {
  border-left-color: hsl(var(--primary));
  background: hsl(var(--primary) / 0.1);
}

.log-active .log-icon {
  color: hsl(var(--primary));
  animation: rotate 2s linear infinite;
}

.log-active .log-content {
  font-weight: 500;
  color: hsl(var(--primary));
}

.log-success {
  border-left-color: hsl(var(--success));
}

.log-success .log-icon {
  color: hsl(var(--success));
}

.log-step {
  border-left-color: hsl(var(--primary));
}

.log-step .log-icon {
  background: hsl(var(--primary));
  color: hsl(var(--primary-foreground));
  border-radius: 4px;
  font-weight: 700;
  font-size: 0.6875rem;
  width: 20px;
  height: 20px;
}

.log-step .log-content {
  font-weight: 600;
  color: hsl(var(--primary));
}

.log-step.log-step-completed {
  border-left-color: hsl(var(--success));
}

.log-step.log-step-completed .log-icon {
  background: hsl(var(--success));
}

.log-step.log-step-completed .log-content {
  color: hsl(var(--success));
}

@keyframes rotate {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

.progress-bar {
  height: 3px;
  background: hsl(var(--border));
  position: relative;
  overflow: hidden;
}

.progress-bar-fill {
  height: 100%;
  background: linear-gradient(90deg, hsl(var(--primary)), hsl(var(--primary) / 0.7));
  transition: width 0.5s ease;
}

/* ============================================
   ACS SCORE CARD (Simplified)
   ============================================ */

.result-card {
  background: hsl(var(--card));
  border: 1px solid hsl(var(--border));
  border-radius: 10px;
  overflow: hidden;
  margin-top: 1rem;
  box-shadow: 0 2px 6px hsl(var(--foreground) / 0.06);
}

.result-card-header {
  padding: 1rem 1.25rem;
  background: hsl(var(--muted));
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.acs-score-badge {
  text-align: right;
}

.acs-score-number {
  font-size: 2rem;
  font-weight: 800;
  color: hsl(var(--success));
}

.acs-score-label {
  font-size: 0.625rem;
  color: hsl(var(--muted-foreground));
  text-transform: uppercase;
  font-weight: 600;
  letter-spacing: 0.05em;
}

/* ============================================
   INPUT AREA - Fixed bottom with gradient backdrop
   ============================================ */

.input-container {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background: linear-gradient(
    to top,
    hsl(var(--muted)) 0%,
    hsl(var(--muted) / 0.9) 40%,
    hsl(var(--muted) / 0.5) 70%,
    transparent 100%
  );
  padding: 2rem 1rem 1.5rem;
  z-index: 100;
  pointer-events: none;
}

.input-wrapper {
  max-width: 900px;
  margin: 0 auto;
  display: flex;
  align-items: center;
  pointer-events: auto;
}

.input-field {
  width: 100%;
  border: 1.5px solid hsl(var(--border));
  border-radius: 12px;
  padding: 0.875rem 1.125rem;
  font-size: 0.9375rem;
  resize: none;
  font-family: inherit;
  line-height: 1.5;
  background: hsl(var(--card));
  color: hsl(var(--foreground));
  box-shadow: 0 2px 8px hsl(var(--foreground) / 0.08), 0 1px 2px hsl(var(--foreground) / 0.06);
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  overflow-y: hidden;
}

.input-field.pr-14 {
  padding-right: 3.5rem;
}

.input-field:focus {
  outline: none;
  border-color: hsl(var(--ring));
  box-shadow: 0 4px 12px hsl(var(--primary) / 0.15), 0 2px 4px hsl(var(--primary) / 0.1);
  transform: translateY(-1px);
}

.send-button {
  background: hsl(var(--foreground));
  color: hsl(var(--background));
  border: none;
  border-radius: 8px;
  padding: 0.5rem;
  width: 36px;
  height: 36px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 1px 3px hsl(var(--foreground) / 0.1);
}

.send-button:hover:not(:disabled) {
  background: hsl(var(--foreground) / 0.9);
  box-shadow: 0 2px 6px hsl(var(--foreground) / 0.15);
}

.send-button:active:not(:disabled) {
  transform: scale(0.95);
}

.send-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* ============================================
   DISCOVERY LOG ANIMATIONS (Claude-style)
   ============================================ */

@keyframes subtle-pulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.6;
  }
}

.discovery-log-progress {
  animation: subtle-pulse 2s ease-in-out infinite;
}

/* Staggered bounce animation for loading dots */
@keyframes bounce-dot {
  0%, 80%, 100% {
    transform: translateY(0);
  }
  40% {
    transform: translateY(-4px);
  }
}

/* ============================================
   HORIZONTAL SCROLL FOR REPO CARDS
   ============================================ */

.repo-scroll-container {
  scrollbar-width: none; /* Firefox */
  -ms-overflow-style: none; /* IE and Edge */
  position: relative;
  scroll-behavior: smooth;
}

.repo-scroll-container::-webkit-scrollbar {
  display: none; /* Chrome, Safari, Opera */
}

/* Gradient fade-out indicators */
.repo-scroll-wrapper {
  position: relative;
}

.repo-scroll-wrapper::before,
.repo-scroll-wrapper::after {
  content: '';
  position: absolute;
  top: 0;
  bottom: 0;
  width: 80px;
  pointer-events: none;
  z-index: 10;
  transition: opacity 0.3s ease;
}

.repo-scroll-wrapper::before {
  left: 0;
  background: linear-gradient(
    to right,
    hsl(var(--background) / 0.8) 0%,
    hsl(var(--background) / 0.6) 30%,
    transparent 100%
  );
}

.repo-scroll-wrapper::after {
  right: 0;
  background: linear-gradient(
    to left,
    hsl(var(--background) / 0.8) 0%,
    hsl(var(--background) / 0.6) 30%,
    transparent 100%
  );
}

@layer utilities {
  .text-balance {
    text-wrap: balance;
  }
}
